{"version":3,"file":"watch.js","sourceRoot":"","sources":["../../../src/cli/commands/watch.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,8CAAwB;AAGxB,sDAAqD;AACrD,wDAAuD;AAEvD,SAAsB,UAAU,CAAC,MAAoB;;;;YAC3C,SAAS,GAAK,MAAM,UAAX,CAAY;YAEvB,OAAO,GAAG,IAAA,cAAI,EAAC,SAAS,EAAE;gBAC9B,IAAI,EAAE,CAAC,kBAAkB,EAAE,iBAAiB,EAAE,iBAAiB,EAAE,kBAAkB,CAAC;gBACpF,OAAO,EAAE,CAAC,cAAc,CAAC;gBACzB,QAAQ,EAAE,IAAI;aACf,CAAC,CAAC;YAEH,kDAAkD;YAClD,0DAA0D;YAC1D,oCAAoC;YACpC,MAAM;YAEN,OAAO,CAAC,EAAE,CAAC,KAAK,EAAE,UAAgB,OAAe;;;;oCAC/C,qBAAM,IAAA,iCAAe,EAAC,CAAC,OAAO,CAAC,EAAE,MAAM,CAAC,EAAA;;gCAAxC,SAAwC,CAAC;gCACzC,OAAO,CAAC,GAAG,CAAC,gBAAS,OAAO,qBAAkB,CAAC,CAAC;;;;;aACjD,CAAC,CAAC;YAEH,OAAO,CAAC,EAAE,CAAC,QAAQ,EAAE,UAAgB,OAAe;;;;oCAClD,qBAAM,IAAA,mCAAgB,EAAC,OAAO,EAAE,MAAM,CAAC,EAAA;;gCAAvC,SAAuC,CAAC;gCACxC,OAAO,CAAC,GAAG,CAAC,kBAAW,OAAO,uBAAoB,CAAC,CAAC;;;;;aACrD,CAAC,CAAC;YAEH,OAAO,CAAC,EAAE,CAAC,OAAO,EAAE;gBAClB,OAAO,CAAC,GAAG,CAAC,kCAA2B,MAAM,CAAC,SAAS,CAAE,CAAC,CAAC;YAC7D,CAAC,CAAC,CAAC;;;;CACJ;AA3BD,gCA2BC","sourcesContent":["import sane from 'sane';\n\nimport { StoryOptions } from '../../types';\nimport { addStoriesAsync } from '../addStoriesAsync';\nimport { removeStoryAsync } from '../removeStoryAsync';\n\nexport async function watchAsync(config: StoryOptions) {\n  const { watchRoot } = config;\n\n  const watcher = sane(watchRoot, {\n    glob: ['**/*.stories.tsx', '**/*.stories.js', '**/*.stories.ts', '**/*.stories.jsx'],\n    ignored: ['node_modules'],\n    watchman: true,\n  });\n\n  // fast refresh will capture any changes to a file\n  // any other listeners would need to go through websockets\n  // watcher.on('change', relPath => {\n  // });\n\n  watcher.on('add', async function (relPath: string) {\n    await addStoriesAsync([relPath], config);\n    console.log(`Added ${relPath} file to stories`);\n  });\n\n  watcher.on('delete', async function (relPath: string) {\n    await removeStoryAsync(relPath, config);\n    console.log(`Removed ${relPath} file from stories`);\n  });\n\n  watcher.on('ready', () => {\n    console.log(`Watching for changes in ${config.watchRoot}`);\n  });\n}\n"]}